
{% extends "layout.html" %}
{% block content %}

<br>
    <div class="card  " >
        <div class="card-header text-white bg-info">
                Commande client
        </div>
        <div class="card-body">
          <h5 class="card-title"> N° {{order.id}} - {{order.title}}</h5>
          <p class="card-text">Commande créée le : {{order.order_dt}} par {{customer.firstname}} {{customer.lastname}}</p>
          <br>
          <p><b>Liste des articles :</b></p>
          <ul class="list-group list-group-flush">
          {% set total = {'value': 0.00} %}
          {% for product in order.selected_products %}
            <li class="list-group-item">
                <span class="badge badge-primary">{{product.price}} €</span> 
                {{product.name}}  
                    {% for product_order in bought_items %}
                        {% if product_order.product_id == product.id %}
                        <span class="badge badge-warning">x {{product_order.quantity}}</span> 
                        {% if total.update({"value": (product_order.quantity * product.price)|float + total.value|float }) %} {% endif %}
                        <span style="float: right"> {{ "%.2f"|format(product_order.quantity * product.price) }}€</span>
                        {% endif%}
                    {% endfor %}
            </li>
          {% endfor %}
          <li class="list-group-item">
                <b><span style="float: right">Total : {{ "%.2f"|format(total.value|float) }}€</span></b>
          </li>
        </ul>

        </div>

      </div>

      <br>
      <div class="card">
          <div class="card-header text-white bg-info">
                  Livraison
          </div>
          <div class="card-body">
            <h5 class="card-title">Date de livraison {{order.delivery_dt}}</h5>
            <p class="card-text">adresse ici</p>
  
          </div>
  
        </div>
        <br>
        <div class="card">
            <div class="card-header text-white bg-info" >
                    Commandes auprès des vendeurs
            </div>
            <div class="card-body">
              <h5 class="card-title"></h5>
              <p class="card-text"></p>
                <ul class="list-group list-group-flush">
                {% for vendorOrder in order.vendorOrders %}
                <li class="list-group-item">
                    <b>Commande n° {{vendorOrder.id}} </b>  <span class="badge badge-warning">{{vendorOrder.status}}</span>
                    <b>Vendeur n° {{vendorOrder.vendor.id}} </b> - {{vendorOrder.vendor.name}}</p>
                </li>    

                {% endfor %}
                </ul>
            </div>
    
          </div>

    
{% endblock %}
{% block right_menu %}
<div class="content-section">
    <h3>Menu des commandes</h3>
    <p class='text-muted'>Une commande client génère des commandes vendeur
        <ul class="list-group">
        <li class="list-group-item list-group-item-light">
                <a class="nav-link" href="/orders/new">Création de commande</a></li>
        <li class="list-group-item list-group-item-light">
                <a class="nav-link" href="/orders">Liste des commandes</a></li>
        <li class="list-group-item list-group-item-light">Calendars</li>
        <li class="list-group-item list-group-item-light">etc</li>
        </ul>
    </p>
</div>
{% endblock %}






